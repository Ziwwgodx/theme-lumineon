{% comment %}
  Template Collection - Page collection avec SEO optimis√©
{% endcomment %}

{% assign page_title = collection.title | append: ' - N√©ons LED Personnalis√©s | LumiN√©on' %}
{% assign page_description = collection.description | strip_html | truncate: 155 | default: 'Collection de n√©ons LED personnalis√©s ' | append: collection.title | append: '. Fabrication fran√ßaise haut de gamme, garantie 2 ans, livraison express France enti√®re.' %}

<!-- SEO Schema Organization -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{{ collection.title | escape }}",
  "description": "{{ page_description | escape }}",
  "url": "{{ shop.url }}{{ collection.url }}",
  "mainEntity": {
    "@type": "ItemList",
    "name": "{{ collection.title | escape }}",
    "description": "{{ collection.description | strip_html | escape }}",
    "numberOfItems": {{ collection.products_count }},
    "itemListElement": [
      {% for product in collection.products limit: 10 %}
        {
          "@type": "Product",
          "position": {{ forloop.index }},
          "name": "{{ product.title | escape }}",
          "description": "{{ product.description | strip_html | truncate: 155 | escape }}",
          "image": "{{ product.featured_image | img_url: 'master' }}",
          "url": "{{ shop.url }}{{ product.url }}",
          "brand": {
            "@type": "Brand",
            "name": "LumiN√©on"
          },
          "offers": {
            "@type": "Offer",
            "price": "{{ product.price | money_without_currency }}",
            "priceCurrency": "{{ cart.currency.iso_code }}",
            "availability": "{% if product.available %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
            "seller": {
              "@type": "Organization",
              "name": "LumiN√©on"
            }
          },
          "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "reviewCount": "127"
          }
        }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Accueil",
        "item": "{{ shop.url }}"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "{{ collection.title | escape }}",
        "item": "{{ shop.url }}{{ collection.url }}"
      }
    ]
  }
}
</script>

<div class="min-h-screen bg-gray-900 text-white py-20">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    
    <!-- Breadcrumb -->
    <nav class="mb-8" aria-label="Fil d'Ariane">
      <ol class="flex items-center space-x-2 text-sm text-gray-400">
        <li><a href="/" class="hover:text-cyan-400 transition-colors">Accueil</a></li>
        <li><span class="mx-2">/</span></li>
        <li class="text-white">{{ collection.title | default: 'N√©ons Personnalis√©s' }}</li>
      </ol>
    </nav>

    <!-- Collection Header -->
    <div class="text-center mb-16">
      <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold mb-6" itemprop="headline">
        <span class="neon-text-gradient">{{ collection.title | default: 'N√©ons LED Personnalis√©s' }}</span>
      </h1>
      
      {% if collection.description != blank %}
        <p class="text-xl text-gray-300 max-w-3xl mx-auto leading-relaxed mb-8" itemprop="description">
          {{ collection.description }}
        </p>
      {% else %}
        <p class="text-xl text-gray-300 max-w-3xl mx-auto leading-relaxed mb-8" itemprop="description">
          ‚ú® D√©couvrez notre collection de n√©ons LED personnalis√©s haut de gamme. 
          <span class="text-cyan-400">Fabrication fran√ßaise artisanale</span>, 
          garantie 2 ans, installation professionnelle partout en France.
        </p>
      {% endif %}

      <!-- Collection Stats -->
      <div class="flex flex-wrap justify-center gap-6 mb-8">
        <div class="flex items-center gap-2 px-4 py-2 bg-cyan-500/20 border border-cyan-500/30 rounded-full text-cyan-300">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
          </svg>
          <span class="font-medium">{{ collection.products_count }} n√©on{% if collection.products_count > 1 %}s{% endif %} disponible{% if collection.products_count > 1 %}s{% endif %}</span>
        </div>
        
        {% if collection.products_count > 0 %}
          <div class="flex items-center gap-2 px-4 py-2 bg-green-500/20 border border-green-500/30 rounded-full text-green-300">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
            </svg>
            <span class="font-medium">√Ä partir de {{ collection.products.first.price | money }}</span>
          </div>
        {% endif %}
        
        <div class="flex items-center gap-2 px-4 py-2 bg-purple-500/20 border border-purple-500/30 rounded-full text-purple-300">
          <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20">
            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
          </svg>
          <span class="font-medium">4.8‚òÖ (127 avis)</span>
        </div>
      </div>

      <!-- CTA Buttons -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <button
          onclick="openDevisPopup()"
          class="group relative px-8 py-4 bg-gradient-to-r from-cyan-500 to-purple-600 rounded-full text-white font-semibold text-lg transition-all duration-300 hover:scale-105 hover:shadow-neon-cyan flex items-center justify-center gap-3"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
          </svg>
          üé® Cr√©er Mon N√©on Sur Mesure
          <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
        
        <a
          href="/pages/customizer"
          class="px-8 py-4 border-2 border-yellow-400 text-yellow-400 rounded-full font-semibold text-lg transition-all duration-300 hover:bg-yellow-400 hover:text-gray-900 hover:shadow-neon-yellow flex items-center justify-center gap-3"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"></path>
          </svg>
          üõ†Ô∏è Utiliser le Customizer 3D
        </a>
      </div>
    </div>

    <!-- Products Section -->
    {% paginate collection.products by 24 %}
      {% if collection.products.size > 0 %}
        
        <!-- Products Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16">
          {% for product in collection.products %}
            <div class="group">
              <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl overflow-hidden border border-gray-700 transition-all duration-300 hover:border-cyan-500/50 hover:shadow-lg hover:shadow-cyan-500/20 h-full flex flex-col">
                
                <!-- Product Image -->
                <div class="relative overflow-hidden aspect-square">
                  {% if product.featured_image %}
                    <img 
                      src="{{ product.featured_image | img_url: '600x600' }}" 
                      alt="N√©on LED {{ product.title | escape }} - Fabrication fran√ßaise"
                      class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                      loading="lazy"
                      width="600"
                      height="600"
                    />
                  {% else %}
                    <div class="w-full h-full bg-gradient-to-br from-gray-700 to-gray-800 flex items-center justify-center">
                      <svg class="w-16 h-16 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                      </svg>
                    </div>
                  {% endif %}
                  
                  <!-- Sale Badge -->
                  {% if product.compare_at_price > product.price %}
                    <div class="absolute top-3 left-3 px-3 py-1 bg-gradient-to-r from-red-500 to-pink-600 rounded-full text-white text-xs font-bold">
                      -{{ product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price }}%
                    </div>
                  {% endif %}
                </div>

                <!-- Product Info -->
                <div class="p-6 flex-1 flex flex-col">
                  <h3 class="text-lg font-semibold mb-3 text-white group-hover:text-cyan-400 transition-colors duration-300 flex-1">
                    {{ product.title }}
                  </h3>
                  
                  <div class="flex items-center justify-between mb-4">
                    <span class="text-xl font-bold text-cyan-400">
                      {{ product.price | money }}
                    </span>
                    {% if product.compare_at_price > product.price %}
                      <span class="text-sm text-gray-500 line-through">
                        {{ product.compare_at_price | money }}
                      </span>
                    {% endif %}
                  </div>

                  <a 
                    href="{{ product.url }}"
                    class="w-full text-center px-4 py-3 bg-gradient-to-r from-cyan-500 to-purple-600 rounded-lg text-white font-medium transition-all duration-300 hover:scale-105"
                  >
                    Voir ce n√©on
                  </a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>

        <!-- Pagination -->
        {% if paginate.pages > 1 %}
          <div class="flex justify-center">
            <nav class="flex items-center gap-2">
              {% if paginate.previous %}
                <a href="{{ paginate.previous.url }}" class="px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white hover:border-cyan-400 transition-colors">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                  </svg>
                </a>
              {% endif %}
              
              {% for part in paginate.parts %}
                {% if part.is_link %}
                  <a href="{{ part.url }}" class="px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white hover:border-cyan-400 transition-colors">
                    {{ part.title }}
                  </a>
                {% else %}
                  <span class="px-4 py-2 bg-gradient-to-r from-cyan-500 to-purple-600 rounded-lg text-white font-semibold">
                    {{ part.title }}
                  </span>
                {% endif %}
              {% endfor %}
              
              {% if paginate.next %}
                <a href="{{ paginate.next.url }}" class="px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white hover:border-cyan-400 transition-colors">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </a>
              {% endif %}
            </nav>
          </div>
        {% endif %}

      {% else %}
        
        <!-- Empty State -->
        <div class="text-center py-20">
          <svg class="w-24 h-24 text-gray-500 mx-auto mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
          </svg>
          <h3 class="text-2xl font-bold text-white mb-4">Collection Vide</h3>
          <p class="text-gray-400 mb-8">Cette collection ne contient aucun produit pour le moment.</p>
          <button onclick="openDevisPopup()" class="px-8 py-4 bg-gradient-to-r from-cyan-500 to-purple-600 rounded-full text-white font-semibold transition-all duration-300 hover:scale-105">
            Cr√©er Mon N√©on Sur Mesure
          </button>
        </div>
        
      {% endif %}
    {% endpaginate %}
  </div>
</div>

<!-- SEO Meta Tags -->
<script>
document.title = '{{ page_title }}';
if (document.querySelector('meta[name="description"]')) {
  document.querySelector('meta[name="description"]').setAttribute('content', '{{ page_description }}');
}
</script>